#name "/afs/.ir/class/cs143/examples/lam.cl"
#21 CLASS
#21 TYPEID VarList
#21 INHERITS
#21 TYPEID IO
#21 '{'
#22 OBJECTID isNil
#22 '('
#22 ')'
#22 ':'
#22 TYPEID Bool
#22 '{'
#22 BOOL_CONST true
#22 '}'
#22 ';'
#23 OBJECTID head
#23 '('
#23 ')'
#23 ':'
#23 TYPEID Variable
#23 '{'
#23 '{'
#23 OBJECTID abort
#23 '('
#23 ')'
#23 ';'
#23 NEW
#23 TYPEID Variable
#23 ';'
#23 '}'
#23 '}'
#23 ';'
#24 OBJECTID tail
#24 '('
#24 ')'
#24 ':'
#24 TYPEID VarList
#24 '{'
#24 '{'
#24 OBJECTID abort
#24 '('
#24 ')'
#24 ';'
#24 NEW
#24 TYPEID VarList
#24 ';'
#24 '}'
#24 '}'
#24 ';'
#25 OBJECTID add
#25 '('
#25 OBJECTID x
#25 ':'
#25 TYPEID Variable
#25 ')'
#25 ':'
#25 TYPEID VarList
#25 '{'
#25 '('
#25 NEW
#25 TYPEID VarListNE
#25 ')'
#25 '.'
#25 OBJECTID init
#25 '('
#25 OBJECTID x
#25 ','
#25 OBJECTID self
#25 ')'
#25 '}'
#25 ';'
#26 OBJECTID print
#26 '('
#26 ')'
#26 ':'
#26 TYPEID SELF_TYPE
#26 '{'
#26 OBJECTID out_string
#26 '('
#26 STR_CONST "\n"
#26 ')'
#26 '}'
#26 ';'
#27 '}'
#27 ';'
#29 CLASS
#29 TYPEID VarListNE
#29 INHERITS
#29 TYPEID VarList
#29 '{'
#30 OBJECTID x
#30 ':'
#30 TYPEID Variable
#30 ';'
#31 OBJECTID rest
#31 ':'
#31 TYPEID VarList
#31 ';'
#32 OBJECTID isNil
#32 '('
#32 ')'
#32 ':'
#32 TYPEID Bool
#32 '{'
#32 BOOL_CONST false
#32 '}'
#32 ';'
#33 OBJECTID head
#33 '('
#33 ')'
#33 ':'
#33 TYPEID Variable
#33 '{'
#33 OBJECTID x
#33 '}'
#33 ';'
#34 OBJECTID tail
#34 '('
#34 ')'
#34 ':'
#34 TYPEID VarList
#34 '{'
#34 OBJECTID rest
#34 '}'
#34 ';'
#35 OBJECTID init
#35 '('
#35 OBJECTID y
#35 ':'
#35 TYPEID Variable
#35 ','
#35 OBJECTID r
#35 ':'
#35 TYPEID VarList
#35 ')'
#35 ':'
#35 TYPEID VarListNE
#35 '{'
#35 '{'
#35 OBJECTID x
#35 ASSIGN
#35 OBJECTID y
#35 ';'
#35 OBJECTID rest
#35 ASSIGN
#35 OBJECTID r
#35 ';'
#35 OBJECTID self
#35 ';'
#35 '}'
#35 '}'
#35 ';'
#36 OBJECTID print
#36 '('
#36 ')'
#36 ':'
#36 TYPEID SELF_TYPE
#36 '{'
#36 '{'
#36 OBJECTID x
#36 '.'
#36 OBJECTID print_self
#36 '('
#36 ')'
#36 ';'
#36 OBJECTID out_string
#36 '('
#36 STR_CONST " "
#36 ')'
#36 ';'
#37 OBJECTID rest
#37 '.'
#37 OBJECTID print
#37 '('
#37 ')'
#37 ';'
#37 OBJECTID self
#37 ';'
#37 '}'
#37 '}'
#37 ';'
#38 '}'
#38 ';'
#44 CLASS
#44 TYPEID LambdaList
#44 '{'
#45 OBJECTID isNil
#45 '('
#45 ')'
#45 ':'
#45 TYPEID Bool
#45 '{'
#45 BOOL_CONST true
#45 '}'
#45 ';'
#46 OBJECTID headE
#46 '('
#46 ')'
#46 ':'
#46 TYPEID VarList
#46 '{'
#46 '{'
#46 OBJECTID abort
#46 '('
#46 ')'
#46 ';'
#46 NEW
#46 TYPEID VarList
#46 ';'
#46 '}'
#46 '}'
#46 ';'
#47 OBJECTID headC
#47 '('
#47 ')'
#47 ':'
#47 TYPEID Lambda
#47 '{'
#47 '{'
#47 OBJECTID abort
#47 '('
#47 ')'
#47 ';'
#47 NEW
#47 TYPEID Lambda
#47 ';'
#47 '}'
#47 '}'
#47 ';'
#48 OBJECTID headN
#48 '('
#48 ')'
#48 ':'
#48 TYPEID Int
#48 '{'
#48 '{'
#48 OBJECTID abort
#48 '('
#48 ')'
#48 ';'
#48 INT_CONST 0
#48 ';'
#48 '}'
#48 '}'
#48 ';'
#49 OBJECTID tail
#49 '('
#49 ')'
#49 ':'
#49 TYPEID LambdaList
#49 '{'
#49 '{'
#49 OBJECTID abort
#49 '('
#49 ')'
#49 ';'
#49 NEW
#49 TYPEID LambdaList
#49 ';'
#49 '}'
#49 '}'
#49 ';'
#50 OBJECTID add
#50 '('
#50 OBJECTID e
#50 ':'
#50 TYPEID VarList
#50 ','
#50 OBJECTID x
#50 ':'
#50 TYPEID Lambda
#50 ','
#50 OBJECTID n
#50 ':'
#50 TYPEID Int
#50 ')'
#50 ':'
#50 TYPEID LambdaList
#50 '{'
#51 '('
#51 NEW
#51 TYPEID LambdaListNE
#51 ')'
#51 '.'
#51 OBJECTID init
#51 '('
#51 OBJECTID e
#51 ','
#51 OBJECTID x
#51 ','
#51 OBJECTID n
#51 ','
#51 OBJECTID self
#51 ')'
#52 '}'
#52 ';'
#53 '}'
#53 ';'
#55 CLASS
#55 TYPEID LambdaListNE
#55 INHERITS
#55 TYPEID LambdaList
#55 '{'
#56 OBJECTID lam
#56 ':'
#56 TYPEID Lambda
#56 ';'
#57 OBJECTID num
#57 ':'
#57 TYPEID Int
#57 ';'
#58 OBJECTID env
#58 ':'
#58 TYPEID VarList
#58 ';'
#59 OBJECTID rest
#59 ':'
#59 TYPEID LambdaList
#59 ';'
#60 OBJECTID isNil
#60 '('
#60 ')'
#60 ':'
#60 TYPEID Bool
#60 '{'
#60 BOOL_CONST false
#60 '}'
#60 ';'
#61 OBJECTID headE
#61 '('
#61 ')'
#61 ':'
#61 TYPEID VarList
#61 '{'
#61 OBJECTID env
#61 '}'
#61 ';'
#62 OBJECTID headC
#62 '('
#62 ')'
#62 ':'
#62 TYPEID Lambda
#62 '{'
#62 OBJECTID lam
#62 '}'
#62 ';'
#63 OBJECTID headN
#63 '('
#63 ')'
#63 ':'
#63 TYPEID Int
#63 '{'
#63 OBJECTID num
#63 '}'
#63 ';'
#64 OBJECTID tail
#64 '('
#64 ')'
#64 ':'
#64 TYPEID LambdaList
#64 '{'
#64 OBJECTID rest
#64 '}'
#64 ';'
#65 OBJECTID init
#65 '('
#65 OBJECTID e
#65 ':'
#65 TYPEID VarList
#65 ','
#65 OBJECTID l
#65 ':'
#65 TYPEID Lambda
#65 ','
#65 OBJECTID n
#65 ':'
#65 TYPEID Int
#65 ','
#65 OBJECTID r
#65 ':'
#65 TYPEID LambdaList
#65 ')'
#65 ':'
#65 TYPEID LambdaListNE
#65 '{'
#66 '{'
#67 OBJECTID env
#67 ASSIGN
#67 OBJECTID e
#67 ';'
#68 OBJECTID lam
#68 ASSIGN
#68 OBJECTID l
#68 ';'
#69 OBJECTID num
#69 ASSIGN
#69 OBJECTID n
#69 ';'
#70 OBJECTID rest
#70 ASSIGN
#70 OBJECTID r
#70 ';'
#71 OBJECTID self
#71 ';'
#72 '}'
#73 '}'
#73 ';'
#74 '}'
#74 ';'
#76 CLASS
#76 TYPEID LambdaListRef
#76 '{'
#77 OBJECTID nextNum
#77 ':'
#77 TYPEID Int
#77 ASSIGN
#77 INT_CONST 0
#77 ';'
#78 OBJECTID l
#78 ':'
#78 TYPEID LambdaList
#78 ';'
#79 OBJECTID isNil
#79 '('
#79 ')'
#79 ':'
#79 TYPEID Bool
#79 '{'
#79 OBJECTID l
#79 '.'
#79 OBJECTID isNil
#79 '('
#79 ')'
#79 '}'
#79 ';'
#80 OBJECTID headE
#80 '('
#80 ')'
#80 ':'
#80 TYPEID VarList
#80 '{'
#80 OBJECTID l
#80 '.'
#80 OBJECTID headE
#80 '('
#80 ')'
#80 '}'
#80 ';'
#81 OBJECTID headC
#81 '('
#81 ')'
#81 ':'
#81 TYPEID Lambda
#81 '{'
#81 OBJECTID l
#81 '.'
#81 OBJECTID headC
#81 '('
#81 ')'
#81 '}'
#81 ';'
#82 OBJECTID headN
#82 '('
#82 ')'
#82 ':'
#82 TYPEID Int
#82 '{'
#82 OBJECTID l
#82 '.'
#82 OBJECTID headN
#82 '('
#82 ')'
#82 '}'
#82 ';'
#83 OBJECTID reset
#83 '('
#83 ')'
#83 ':'
#83 TYPEID SELF_TYPE
#83 '{'
#84 '{'
#85 OBJECTID nextNum
#85 ASSIGN
#85 INT_CONST 0
#85 ';'
#86 OBJECTID l
#86 ASSIGN
#86 NEW
#86 TYPEID LambdaList
#86 ';'
#87 OBJECTID self
#87 ';'
#88 '}'
#89 '}'
#89 ';'
#90 OBJECTID add
#90 '('
#90 OBJECTID env
#90 ':'
#90 TYPEID VarList
#90 ','
#90 OBJECTID c
#90 ':'
#90 TYPEID Lambda
#90 ')'
#90 ':'
#90 TYPEID Int
#90 '{'
#91 '{'
#92 OBJECTID l
#92 ASSIGN
#92 OBJECTID l
#92 '.'
#92 OBJECTID add
#92 '('
#92 OBJECTID env
#92 ','
#92 OBJECTID c
#92 ','
#92 OBJECTID nextNum
#92 ')'
#92 ';'
#93 OBJECTID nextNum
#93 ASSIGN
#93 OBJECTID nextNum
#93 '+'
#93 INT_CONST 1
#93 ';'
#94 OBJECTID nextNum
#94 '-'
#94 INT_CONST 1
#94 ';'
#95 '}'
#96 '}'
#96 ';'
#97 OBJECTID removeHead
#97 '('
#97 ')'
#97 ':'
#97 TYPEID SELF_TYPE
#97 '{'
#98 '{'
#99 OBJECTID l
#99 ASSIGN
#99 OBJECTID l
#99 '.'
#99 OBJECTID tail
#99 '('
#99 ')'
#99 ';'
#100 OBJECTID self
#100 ';'
#101 '}'
#102 '}'
#102 ';'
#103 '}'
#103 ';'
#111 CLASS
#111 TYPEID Expr
#111 INHERITS
#111 TYPEID IO
#111 '{'
#114 OBJECTID print_self
#114 '('
#114 ')'
#114 ':'
#114 TYPEID SELF_TYPE
#114 '{'
#115 '{'
#116 OBJECTID out_string
#116 '('
#116 STR_CONST "\nnError: Expr is pure virtual; can't print selfn"
#116 ')'
#116 ';'
#117 OBJECTID abort
#117 '('
#117 ')'
#117 ';'
#118 OBJECTID self
#118 ';'
#119 '}'
#120 '}'
#120 ';'
#123 OBJECTID beta
#123 '('
#123 ')'
#123 ':'
#123 TYPEID Expr
#123 '{'
#124 '{'
#125 OBJECTID out_string
#125 '('
#125 STR_CONST "\nnError: Expr is pure virtual; can't beta-reducen"
#125 ')'
#125 ';'
#126 OBJECTID abort
#126 '('
#126 ')'
#126 ';'
#127 OBJECTID self
#127 ';'
#128 '}'
#129 '}'
#129 ';'
#132 OBJECTID substitute
#132 '('
#132 OBJECTID x
#132 ':'
#132 TYPEID Variable
#132 ','
#132 OBJECTID e
#132 ':'
#132 TYPEID Expr
#132 ')'
#132 ':'
#132 TYPEID Expr
#132 '{'
#133 '{'
#134 OBJECTID out_string
#134 '('
#134 STR_CONST "\nnError: Expr is pure virtual; can't substituten"
#134 ')'
#134 ';'
#135 OBJECTID abort
#135 '('
#135 ')'
#135 ';'
#136 OBJECTID self
#136 ';'
#137 '}'
#138 '}'
#138 ';'
#141 OBJECTID gen_code
#141 '('
#141 OBJECTID env
#141 ':'
#141 TYPEID VarList
#141 ','
#141 OBJECTID closures
#141 ':'
#141 TYPEID LambdaListRef
#141 ')'
#141 ':'
#141 TYPEID SELF_TYPE
#141 '{'
#142 '{'
#143 OBJECTID out_string
#143 '('
#143 STR_CONST "\nnError: Expr is pure virtual; can't gen_coden"
#143 ')'
#143 ';'
#144 OBJECTID abort
#144 '('
#144 ')'
#144 ';'
#145 OBJECTID self
#145 ';'
#146 '}'
#147 '}'
#147 ';'
#148 '}'
#148 ';'
#153 CLASS
#153 TYPEID Variable
#153 INHERITS
#153 TYPEID Expr
#153 '{'
#154 OBJECTID name
#154 ':'
#154 TYPEID String
#154 ';'
#156 OBJECTID init
#156 '('
#156 OBJECTID n
#156 ':'
#156 TYPEID String
#156 ')'
#156 ':'
#156 TYPEID Variable
#156 '{'
#157 '{'
#158 OBJECTID name
#158 ASSIGN
#158 OBJECTID n
#158 ';'
#159 OBJECTID self
#159 ';'
#160 '}'
#161 '}'
#161 ';'
#163 OBJECTID print_self
#163 '('
#163 ')'
#163 ':'
#163 TYPEID SELF_TYPE
#163 '{'
#164 OBJECTID out_string
#164 '('
#164 OBJECTID name
#164 ')'
#165 '}'
#165 ';'
#167 OBJECTID beta
#167 '('
#167 ')'
#167 ':'
#167 TYPEID Expr
#167 '{'
#167 OBJECTID self
#167 '}'
#167 ';'
#169 OBJECTID substitute
#169 '('
#169 OBJECTID x
#169 ':'
#169 TYPEID Variable
#169 ','
#169 OBJECTID e
#169 ':'
#169 TYPEID Expr
#169 ')'
#169 ':'
#169 TYPEID Expr
#169 '{'
#170 IF
#170 OBJECTID x
#170 '='
#170 OBJECTID self
#170 THEN
#170 OBJECTID e
#170 ELSE
#170 OBJECTID self
#170 FI
#171 '}'
#171 ';'
#173 OBJECTID gen_code
#173 '('
#173 OBJECTID env
#173 ':'
#173 TYPEID VarList
#173 ','
#173 OBJECTID closures
#173 ':'
#173 TYPEID LambdaListRef
#173 ')'
#173 ':'
#173 TYPEID SELF_TYPE
#173 '{'
#174 LET
#174 OBJECTID cur_env
#174 ':'
#174 TYPEID VarList
#174 ASSIGN
#174 OBJECTID env
#174 IN
#175 '{'
#175 WHILE
#175 '('
#175 IF
#175 OBJECTID cur_env
#175 '.'
#175 OBJECTID isNil
#175 '('
#175 ')'
#175 THEN
#176 BOOL_CONST false
#177 ELSE
#178 NOT
#178 '('
#178 OBJECTID cur_env
#178 '.'
#178 OBJECTID head
#178 '('
#178 ')'
#178 '='
#178 OBJECTID self
#178 ')'
#179 FI
#179 ')'
#179 LOOP
#180 '{'
#180 OBJECTID out_string
#180 '('
#180 STR_CONST "get_parent()."
#180 ')'
#180 ';'
#181 OBJECTID cur_env
#181 ASSIGN
#181 OBJECTID cur_env
#181 '.'
#181 OBJECTID tail
#181 '('
#181 ')'
#181 ';'
#182 '}'
#183 POOL
#183 ';'
#184 IF
#184 OBJECTID cur_env
#184 '.'
#184 OBJECTID isNil
#184 '('
#184 ')'
#184 THEN
#185 '{'
#185 OBJECTID out_string
#185 '('
#185 STR_CONST "Error:  free occurrence of "
#185 ')'
#185 ';'
#186 OBJECTID print_self
#186 '('
#186 ')'
#186 ';'
#187 OBJECTID out_string
#187 '('
#187 STR_CONST "\n"
#187 ')'
#187 ';'
#188 OBJECTID abort
#188 '('
#188 ')'
#188 ';'
#189 OBJECTID self
#189 ';'
#190 '}'
#191 ELSE
#192 OBJECTID out_string
#192 '('
#192 STR_CONST "get_x()"
#192 ')'
#193 FI
#193 ';'
#194 '}'
#195 '}'
#195 ';'
#196 '}'
#196 ';'
#201 CLASS
#201 TYPEID Lambda
#201 INHERITS
#201 TYPEID Expr
#201 '{'
#202 OBJECTID arg
#202 ':'
#202 TYPEID Variable
#202 ';'
#203 OBJECTID body
#203 ':'
#203 TYPEID Expr
#203 ';'
#205 OBJECTID init
#205 '('
#205 OBJECTID a
#205 ':'
#205 TYPEID Variable
#205 ','
#205 OBJECTID b
#205 ':'
#205 TYPEID Expr
#205 ')'
#205 ':'
#205 TYPEID Lambda
#205 '{'
#206 '{'
#207 OBJECTID arg
#207 ASSIGN
#207 OBJECTID a
#207 ';'
#208 OBJECTID body
#208 ASSIGN
#208 OBJECTID b
#208 ';'
#209 OBJECTID self
#209 ';'
#210 '}'
#211 '}'
#211 ';'
#213 OBJECTID print_self
#213 '('
#213 ')'
#213 ':'
#213 TYPEID SELF_TYPE
#213 '{'
#214 '{'
#215 OBJECTID out_string
#215 '('
#215 STR_CONST "\\\\"
#215 ')'
#215 ';'
#216 OBJECTID arg
#216 '.'
#216 OBJECTID print_self
#216 '('
#216 ')'
#216 ';'
#217 OBJECTID out_string
#217 '('
#217 STR_CONST "."
#217 ')'
#217 ';'
#218 OBJECTID body
#218 '.'
#218 OBJECTID print_self
#218 '('
#218 ')'
#218 ';'
#219 OBJECTID self
#219 ';'
#220 '}'
#221 '}'
#221 ';'
#223 OBJECTID beta
#223 '('
#223 ')'
#223 ':'
#223 TYPEID Expr
#223 '{'
#223 OBJECTID self
#223 '}'
#223 ';'
#225 OBJECTID apply
#225 '('
#225 OBJECTID actual
#225 ':'
#225 TYPEID Expr
#225 ')'
#225 ':'
#225 TYPEID Expr
#225 '{'
#226 OBJECTID body
#226 '.'
#226 OBJECTID substitute
#226 '('
#226 OBJECTID arg
#226 ','
#226 OBJECTID actual
#226 ')'
#227 '}'
#227 ';'
#230 OBJECTID substitute
#230 '('
#230 OBJECTID x
#230 ':'
#230 TYPEID Variable
#230 ','
#230 OBJECTID e
#230 ':'
#230 TYPEID Expr
#230 ')'
#230 ':'
#230 TYPEID Expr
#230 '{'
#231 IF
#231 OBJECTID x
#231 '='
#231 OBJECTID arg
#231 THEN
#232 OBJECTID self
#233 ELSE
#234 LET
#234 OBJECTID new_body
#234 ':'
#234 TYPEID Expr
#234 ASSIGN
#234 OBJECTID body
#234 '.'
#234 OBJECTID substitute
#234 '('
#234 OBJECTID x
#234 ','
#234 OBJECTID e
#234 ')'
#234 ','
#235 OBJECTID new_lam
#235 ':'
#235 TYPEID Lambda
#235 ASSIGN
#235 NEW
#235 TYPEID Lambda
#235 IN
#236 OBJECTID new_lam
#236 '.'
#236 OBJECTID init
#236 '('
#236 OBJECTID arg
#236 ','
#236 OBJECTID new_body
#236 ')'
#237 FI
#238 '}'
#238 ';'
#240 OBJECTID gen_code
#240 '('
#240 OBJECTID env
#240 ':'
#240 TYPEID VarList
#240 ','
#240 OBJECTID closures
#240 ':'
#240 TYPEID LambdaListRef
#240 ')'
#240 ':'
#240 TYPEID SELF_TYPE
#240 '{'
#241 '{'
#242 OBJECTID out_string
#242 '('
#242 STR_CONST "((new Closure"
#242 ')'
#242 ';'
#243 OBJECTID out_int
#243 '('
#243 OBJECTID closures
#243 '.'
#243 OBJECTID add
#243 '('
#243 OBJECTID env
#243 ','
#243 OBJECTID self
#243 ')'
#243 ')'
#243 ';'
#244 OBJECTID out_string
#244 '('
#244 STR_CONST ").init("
#244 ')'
#244 ';'
#245 IF
#245 OBJECTID env
#245 '.'
#245 OBJECTID isNil
#245 '('
#245 ')'
#245 THEN
#246 OBJECTID out_string
#246 '('
#246 STR_CONST "new Closure))"
#246 ')'
#247 ELSE
#248 OBJECTID out_string
#248 '('
#248 STR_CONST "self))"
#248 ')'
#248 FI
#248 ';'
#249 OBJECTID self
#249 ';'
#250 '}'
#251 '}'
#251 ';'
#253 OBJECTID gen_closure_code
#253 '('
#253 OBJECTID n
#253 ':'
#253 TYPEID Int
#253 ','
#253 OBJECTID env
#253 ':'
#253 TYPEID VarList
#253 ','
#254 OBJECTID closures
#254 ':'
#254 TYPEID LambdaListRef
#254 ')'
#254 ':'
#254 TYPEID SELF_TYPE
#254 '{'
#255 '{'
#256 OBJECTID out_string
#256 '('
#256 STR_CONST "class Closure"
#256 ')'
#256 ';'
#257 OBJECTID out_int
#257 '('
#257 OBJECTID n
#257 ')'
#257 ';'
#258 OBJECTID out_string
#258 '('
#258 STR_CONST " inherits Closure {\\n"
#258 ')'
#258 ';'
#259 OBJECTID out_string
#259 '('
#259 STR_CONST "  apply(y : EvalObject) : EvalObject {\\n"
#259 ')'
#259 ';'
#260 OBJECTID out_string
#260 '('
#260 STR_CONST "    { out_string(\\"
#260 TYPEID Applying
#260 OBJECTID closure
#260 STR_CONST ");\n      out_int(n);\n      out_string("
\\#260 OBJECTID n
\#260 STR_CONST ");\\n"
#260 ')'
#260 ';'
#261 OBJECTID out_string
#261 '('
#261 STR_CONST "      x <- y;\\n"
#261 ')'
#261 ';'
#262 OBJECTID body
#262 '.'
#262 OBJECTID gen_code
#262 '('
#262 OBJECTID env
#262 '.'
#262 OBJECTID add
#262 '('
#262 OBJECTID arg
#262 ')'
#262 ','
#262 OBJECTID closures
#262 ')'
#262 ';'
#263 OBJECTID out_string
#263 '('
#263 STR_CONST ";}};\\n"
#263 ')'
#263 ';'
#264 OBJECTID out_string
#264 '('
#264 STR_CONST "};\\n"
#264 ')'
#264 ';'
#265 '}'
#266 '}'
#266 ';'
#267 '}'
#267 ';'
#272 CLASS
#272 TYPEID App
#272 INHERITS
#272 TYPEID Expr
#272 '{'
#273 OBJECTID fun
#273 ':'
#273 TYPEID Expr
#273 ';'
#274 OBJECTID arg
#274 ':'
#274 TYPEID Expr
#274 ';'
#276 OBJECTID init
#276 '('
#276 OBJECTID f
#276 ':'
#276 TYPEID Expr
#276 ','
#276 OBJECTID a
#276 ':'
#276 TYPEID Expr
#276 ')'
#276 ':'
#276 TYPEID App
#276 '{'
#277 '{'
#278 OBJECTID fun
#278 ASSIGN
#278 OBJECTID f
#278 ';'
#279 OBJECTID arg
#279 ASSIGN
#279 OBJECTID a
#279 ';'
#280 OBJECTID self
#280 ';'
#281 '}'
#282 '}'
#282 ';'
#284 OBJECTID print_self
#284 '('
#284 ')'
#284 ':'
#284 TYPEID SELF_TYPE
#284 '{'
#285 '{'
#286 OBJECTID out_string
#286 '('
#286 STR_CONST "(("
#286 ')'
#286 ';'
#287 OBJECTID fun
#287 '.'
#287 OBJECTID print_self
#287 '('
#287 ')'
#287 ';'
#288 OBJECTID out_string
#288 '('
#288 STR_CONST ")@("
#288 ')'
#288 ';'
#289 OBJECTID arg
#289 '.'
#289 OBJECTID print_self
#289 '('
#289 ')'
#289 ';'
#290 OBJECTID out_string
#290 '('
#290 STR_CONST "))"
#290 ')'
#290 ';'
#291 OBJECTID self
#291 ';'
#292 '}'
#293 '}'
#293 ';'
#295 OBJECTID beta
#295 '('
#295 ')'
#295 ':'
#295 TYPEID Expr
#295 '{'
#296 CASE
#296 OBJECTID fun
#296 OF
#297 OBJECTID l
#297 ':'
#297 TYPEID Lambda
#297 DARROW
#297 OBJECTID l
#297 '.'
#297 OBJECTID apply
#297 '('
#297 OBJECTID arg
#297 ')'
#297 ';'
#298 OBJECTID e
#298 ':'
#298 TYPEID Expr
#298 DARROW
#299 LET
#299 OBJECTID new_fun
#299 ':'
#299 TYPEID Expr
#299 ASSIGN
#299 OBJECTID fun
#299 '.'
#299 OBJECTID beta
#299 '('
#299 ')'
#299 ','
#300 OBJECTID new_app
#300 ':'
#300 TYPEID App
#300 ASSIGN
#300 NEW
#300 TYPEID App
#300 IN
#301 OBJECTID new_app
#301 '.'
#301 OBJECTID init
#301 '('
#301 OBJECTID new_fun
#301 ','
#301 OBJECTID arg
#301 ')'
#301 ';'
#302 ESAC
#303 '}'
#303 ';'
#305 OBJECTID substitute
#305 '('
#305 OBJECTID x
#305 ':'
#305 TYPEID Variable
#305 ','
#305 OBJECTID e
#305 ':'
#305 TYPEID Expr
#305 ')'
#305 ':'
#305 TYPEID Expr
#305 '{'
#306 LET
#306 OBJECTID new_fun
#306 ':'
#306 TYPEID Expr
#306 ASSIGN
#306 OBJECTID fun
#306 '.'
#306 OBJECTID substitute
#306 '('
#306 OBJECTID x
#306 ','
#306 OBJECTID e
#306 ')'
#306 ','
#307 OBJECTID new_arg
#307 ':'
#307 TYPEID Expr
#307 ASSIGN
#307 OBJECTID arg
#307 '.'
#307 OBJECTID substitute
#307 '('
#307 OBJECTID x
#307 ','
#307 OBJECTID e
#307 ')'
#307 ','
#308 OBJECTID new_app
#308 ':'
#308 TYPEID App
#308 ASSIGN
#308 NEW
#308 TYPEID App
#308 IN
#309 OBJECTID new_app
#309 '.'
#309 OBJECTID init
#309 '('
#309 OBJECTID new_fun
#309 ','
#309 OBJECTID new_arg
#309 ')'
#310 '}'
#310 ';'
#312 OBJECTID gen_code
#312 '('
#312 OBJECTID env
#312 ':'
#312 TYPEID VarList
#312 ','
#312 OBJECTID closures
#312 ':'
#312 TYPEID LambdaListRef
#312 ')'
#312 ':'
#312 TYPEID SELF_TYPE
#312 '{'
#313 '{'
#314 OBJECTID out_string
#314 '('
#314 STR_CONST "(let x : EvalObject <- "
#314 ')'
#314 ';'
#315 OBJECTID fun
#315 '.'
#315 OBJECTID gen_code
#315 '('
#315 OBJECTID env
#315 ','
#315 OBJECTID closures
#315 ')'
#315 ';'
#316 OBJECTID out_string
#316 '('
#316 STR_CONST ",\\n"
#316 ')'
#316 ';'
#317 OBJECTID out_string
#317 '('
#317 STR_CONST "     y : EvalObject <- "
#317 ')'
#317 ';'
#318 OBJECTID arg
#318 '.'
#318 OBJECTID gen_code
#318 '('
#318 OBJECTID env
#318 ','
#318 OBJECTID closures
#318 ')'
#318 ';'
#319 OBJECTID out_string
#319 '('
#319 STR_CONST " in\\n"
#319 ')'
#319 ';'
#320 OBJECTID out_string
#320 '('
#320 STR_CONST "  case x of\\n"
#320 ')'
#320 ';'
#321 OBJECTID out_string
#321 '('
#321 STR_CONST "    c : Closure => c.apply(y);\\n"
#321 ')'
#321 ';'
#322 OBJECTID out_string
#322 '('
#322 STR_CONST "    o : Object => { abort(); new EvalObject; };\\n"
#322 ')'
#322 ';'
#323 OBJECTID out_string
#323 '('
#323 STR_CONST "  esac)"
#323 ')'
#323 ';'
#324 '}'
#325 '}'
#325 ';'
#326 '}'
#326 ';'
#333 CLASS
#333 TYPEID Term
#333 INHERITS
#333 TYPEID IO
#333 '{'
#337 OBJECTID var
#337 '('
#337 OBJECTID x
#337 ':'
#337 TYPEID String
#337 ')'
#337 ':'
#337 TYPEID Variable
#337 '{'
#338 LET
#338 OBJECTID v
#338 ':'
#338 TYPEID Variable
#338 ASSIGN
#338 NEW
#338 TYPEID Variable
#338 IN
#339 OBJECTID v
#339 '.'
#339 OBJECTID init
#339 '('
#339 OBJECTID x
#339 ')'
#340 '}'
#340 ';'
#342 OBJECTID lam
#342 '('
#342 OBJECTID x
#342 ':'
#342 TYPEID Variable
#342 ','
#342 OBJECTID e
#342 ':'
#342 TYPEID Expr
#342 ')'
#342 ':'
#342 TYPEID Lambda
#342 '{'
#343 LET
#343 OBJECTID l
#343 ':'
#343 TYPEID Lambda
#343 ASSIGN
#343 NEW
#343 TYPEID Lambda
#343 IN
#344 OBJECTID l
#344 '.'
#344 OBJECTID init
#344 '('
#344 OBJECTID x
#344 ','
#344 OBJECTID e
#344 ')'
#345 '}'
#345 ';'
#347 OBJECTID app
#347 '('
#347 OBJECTID e1
#347 ':'
#347 TYPEID Expr
#347 ','
#347 OBJECTID e2
#347 ':'
#347 TYPEID Expr
#347 ')'
#347 ':'
#347 TYPEID App
#347 '{'
#348 LET
#348 OBJECTID a
#348 ':'
#348 TYPEID App
#348 ASSIGN
#348 NEW
#348 TYPEID App
#348 IN
#349 OBJECTID a
#349 '.'
#349 OBJECTID init
#349 '('
#349 OBJECTID e1
#349 ','
#349 OBJECTID e2
#349 ')'
#350 '}'
#350 ';'
#355 OBJECTID i
#355 '('
#355 ')'
#355 ':'
#355 TYPEID Expr
#355 '{'
#356 LET
#356 OBJECTID x
#356 ':'
#356 TYPEID Variable
#356 ASSIGN
#356 OBJECTID var
#356 '('
#356 STR_CONST "x"
#356 ')'
#356 IN
#357 OBJECTID lam
#357 '('
#357 OBJECTID x
#357 ','
#357 OBJECTID x
#357 ')'
#358 '}'
#358 ';'
#360 OBJECTID k
#360 '('
#360 ')'
#360 ':'
#360 TYPEID Expr
#360 '{'
#361 LET
#361 OBJECTID x
#361 ':'
#361 TYPEID Variable
#361 ASSIGN
#361 OBJECTID var
#361 '('
#361 STR_CONST "x"
#361 ')'
#361 ','
#362 OBJECTID y
#362 ':'
#362 TYPEID Variable
#362 ASSIGN
#362 OBJECTID var
#362 '('
#362 STR_CONST "y"
#362 ')'
#362 IN
#363 OBJECTID lam
#363 '('
#363 OBJECTID x
#363 ','
#363 OBJECTID lam
#363 '('
#363 OBJECTID y
#363 ','
#363 OBJECTID x
#363 ')'
#363 ')'
#364 '}'
#364 ';'
#366 OBJECTID s
#366 '('
#366 ')'
#366 ':'
#366 TYPEID Expr
#366 '{'
#367 LET
#367 OBJECTID x
#367 ':'
#367 TYPEID Variable
#367 ASSIGN
#367 OBJECTID var
#367 '('
#367 STR_CONST "x"
#367 ')'
#367 ','
#368 OBJECTID y
#368 ':'
#368 TYPEID Variable
#368 ASSIGN
#368 OBJECTID var
#368 '('
#368 STR_CONST "y"
#368 ')'
#368 ','
#369 OBJECTID z
#369 ':'
#369 TYPEID Variable
#369 ASSIGN
#369 OBJECTID var
#369 '('
#369 STR_CONST "z"
#369 ')'
#369 IN
#370 OBJECTID lam
#370 '('
#370 OBJECTID x
#370 ','
#370 OBJECTID lam
#370 '('
#370 OBJECTID y
#370 ','
#370 OBJECTID lam
#370 '('
#370 OBJECTID z
#370 ','
#370 OBJECTID app
#370 '('
#370 OBJECTID app
#370 '('
#370 OBJECTID x
#370 ','
#370 OBJECTID z
#370 ')'
#370 ','
#370 OBJECTID app
#370 '('
#370 OBJECTID y
#370 ','
#370 OBJECTID z
#370 ')'
#370 ')'
#370 ')'
#370 ')'
#370 ')'
#371 '}'
#371 ';'
#373 '}'
#373 ';'
#381 CLASS
#381 TYPEID Main
#381 INHERITS
#381 TYPEID Term
#381 '{'
#383 OBJECTID beta_reduce
#383 '('
#383 OBJECTID e
#383 ':'
#383 TYPEID Expr
#383 ')'
#383 ':'
#383 TYPEID Expr
#383 '{'
#384 '{'
#385 OBJECTID out_string
#385 '('
#385 STR_CONST "beta-reduce: "
#385 ')'
#385 ';'
#386 OBJECTID e
#386 '.'
#386 OBJECTID print_self
#386 '('
#386 ')'
#386 ';'
#387 LET
#387 OBJECTID done
#387 ':'
#387 TYPEID Bool
#387 ASSIGN
#387 BOOL_CONST false
#387 ','
#388 OBJECTID new_expr
#388 ':'
#388 TYPEID Expr
#388 IN
#389 '{'
#390 WHILE
#390 '('
#390 NOT
#390 OBJECTID done
#390 ')'
#390 LOOP
#391 '{'
#392 OBJECTID new_expr
#392 ASSIGN
#392 OBJECTID e
#392 '.'
#392 OBJECTID beta
#392 '('
#392 ')'
#392 ';'
#393 IF
#393 '('
#393 OBJECTID new_expr
#393 '='
#393 OBJECTID e
#393 ')'
#393 THEN
#394 OBJECTID done
#394 ASSIGN
#394 BOOL_CONST true
#395 ELSE
#396 '{'
#397 OBJECTID e
#397 ASSIGN
#397 OBJECTID new_expr
#397 ';'
#398 OBJECTID out_string
#398 '('
#398 STR_CONST " =>\\n"
#398 ')'
#398 ';'
#399 OBJECTID e
#399 '.'
#399 OBJECTID print_self
#399 '('
#399 ')'
#399 ';'
#400 '}'
#401 FI
#401 ';'
#402 '}'
#403 POOL
#403 ';'
#404 OBJECTID out_string
#404 '('
#404 STR_CONST "\n"
#404 ')'
#404 ';'
#405 OBJECTID e
#405 ';'
#406 '}'
#406 ';'
#407 '}'
#408 '}'
#408 ';'
#410 OBJECTID eval_class
#410 '('
#410 ')'
#410 ':'
#410 TYPEID SELF_TYPE
#410 '{'
#411 '{'
#412 OBJECTID out_string
#412 '('
#412 STR_CONST "class EvalObject inherits IO {\\n"
#412 ')'
#412 ';'
#413 OBJECTID out_string
#413 '('
#413 STR_CONST "  eval() : EvalObject { { abort(); self; } };\\n"
#413 ')'
#413 ';'
#414 OBJECTID out_string
#414 '('
#414 STR_CONST "};\\n"
#414 ')'
#414 ';'
#415 '}'
#416 '}'
#416 ';'
#418 OBJECTID closure_class
#418 '('
#418 ')'
#418 ':'
#418 TYPEID SELF_TYPE
#418 '{'
#419 '{'
#420 OBJECTID out_string
#420 '('
#420 STR_CONST "class Closure inherits EvalObject {\\n"
#420 ')'
#420 ';'
#421 OBJECTID out_string
#421 '('
#421 STR_CONST "  parent : Closure;\\n"
#421 ')'
#421 ';'
#422 OBJECTID out_string
#422 '('
#422 STR_CONST "  x : EvalObject;\\n"
#422 ')'
#422 ';'
#423 OBJECTID out_string
#423 '('
#423 STR_CONST "  get_parent() : Closure { parent };\\n"
#423 ')'
#423 ';'
#424 OBJECTID out_string
#424 '('
#424 STR_CONST "  get_x() : EvalObject { x };\\n"
#424 ')'
#424 ';'
#425 OBJECTID out_string
#425 '('
#425 STR_CONST "  init(p : Closure) : Closure {{ parent <- p; self; }};\\n"
#425 ')'
#425 ';'
#426 OBJECTID out_string
#426 '('
#426 STR_CONST "  apply(y : EvalObject) : EvalObject { { abort(); self; } };\\n"
#426 ')'
#426 ';'
#427 OBJECTID out_string
#427 '('
#427 STR_CONST "};\\n"
#427 ')'
#427 ';'
#428 '}'
#429 '}'
#429 ';'
#431 OBJECTID gen_code
#431 '('
#431 OBJECTID e
#431 ':'
#431 TYPEID Expr
#431 ')'
#431 ':'
#431 TYPEID SELF_TYPE
#431 '{'
#432 LET
#432 OBJECTID cl
#432 ':'
#432 TYPEID LambdaListRef
#432 ASSIGN
#432 '('
#432 NEW
#432 TYPEID LambdaListRef
#432 ')'
#432 '.'
#432 OBJECTID reset
#432 '('
#432 ')'
#432 IN
#433 '{'
#434 OBJECTID out_string
#434 '('
#434 STR_CONST "Generating code for "
#434 ')'
#434 ';'
#435 OBJECTID e
#435 '.'
#435 OBJECTID print_self
#435 '('
#435 ')'
#435 ';'
#436 OBJECTID out_string
#436 '('
#436 STR_CONST "\nn------------------cut here------------------n"
#436 ')'
#436 ';'
#437 OBJECTID out_string
#437 '('
#437 STR_CONST "(*Generated by lam.cl (Jeff Foster, March 2000)*)\\n"
#437 ')'
#437 ';'
#438 OBJECTID eval_class
#438 '('
#438 ')'
#438 ';'
#439 OBJECTID closure_class
#439 '('
#439 ')'
#439 ';'
#440 OBJECTID out_string
#440 '('
#440 STR_CONST "class Main {\\n"
#440 ')'
#440 ';'
#441 OBJECTID out_string
#441 '('
#441 STR_CONST "  main() : EvalObject {\\n"
#441 ')'
#441 ';'
#442 OBJECTID e
#442 '.'
#442 OBJECTID gen_code
#442 '('
#442 NEW
#442 TYPEID VarList
#442 ','
#442 OBJECTID cl
#442 ')'
#442 ';'
#443 OBJECTID out_string
#443 '('
#443 STR_CONST "\nn};\\n};n"
#443 ')'
#443 ';'
#444 WHILE
#444 '('
#444 NOT
#444 '('
#444 OBJECTID cl
#444 '.'
#444 OBJECTID isNil
#444 '('
#444 ')'
#444 ')'
#444 ')'
#444 LOOP
#445 LET
#445 OBJECTID e
#445 ':'
#445 TYPEID VarList
#445 ASSIGN
#445 OBJECTID cl
#445 '.'
#445 OBJECTID headE
#445 '('
#445 ')'
#445 ','
#446 OBJECTID c
#446 ':'
#446 TYPEID Lambda
#446 ASSIGN
#446 OBJECTID cl
#446 '.'
#446 OBJECTID headC
#446 '('
#446 ')'
#446 ','
#447 OBJECTID n
#447 ':'
#447 TYPEID Int
#447 ASSIGN
#447 OBJECTID cl
#447 '.'
#447 OBJECTID headN
#447 '('
#447 ')'
#447 IN
#448 '{'
#449 OBJECTID cl
#449 '.'
#449 OBJECTID removeHead
#449 '('
#449 ')'
#449 ';'
#450 OBJECTID c
#450 '.'
#450 OBJECTID gen_closure_code
#450 '('
#450 OBJECTID n
#450 ','
#450 OBJECTID e
#450 ','
#450 OBJECTID cl
#450 ')'
#450 ';'
#451 '}'
#452 POOL
#452 ';'
#453 OBJECTID out_string
#453 '('
#453 STR_CONST "\nn------------------cut here------------------n"
#453 ')'
#453 ';'
#454 '}'
#455 '}'
#455 ';'
#457 OBJECTID main
#457 '('
#457 ')'
#457 ':'
#457 TYPEID Int
#457 '{'
#458 '{'
#459 OBJECTID i
#459 '('
#459 ')'
#459 '.'
#459 OBJECTID print_self
#459 '('
#459 ')'
#459 ';'
#460 OBJECTID out_string
#460 '('
#460 STR_CONST "\n"
#460 ')'
#460 ';'
#461 OBJECTID k
#461 '('
#461 ')'
#461 '.'
#461 OBJECTID print_self
#461 '('
#461 ')'
#461 ';'
#462 OBJECTID out_string
#462 '('
#462 STR_CONST "\n"
#462 ')'
#462 ';'
#463 OBJECTID s
#463 '('
#463 ')'
#463 '.'
#463 OBJECTID print_self
#463 '('
#463 ')'
#463 ';'
#464 OBJECTID out_string
#464 '('
#464 STR_CONST "\n"
#464 ')'
#464 ';'
#465 OBJECTID beta_reduce
#465 '('
#465 OBJECTID app
#465 '('
#465 OBJECTID app
#465 '('
#465 OBJECTID app
#465 '('
#465 OBJECTID s
#465 '('
#465 ')'
#465 ','
#465 OBJECTID k
#465 '('
#465 ')'
#465 ')'
#465 ','
#465 OBJECTID i
#465 '('
#465 ')'
#465 ')'
#465 ','
#465 OBJECTID i
#465 '('
#465 ')'
#465 ')'
#465 ')'
#465 ';'
#466 OBJECTID beta_reduce
#466 '('
#466 OBJECTID app
#466 '('
#466 OBJECTID app
#466 '('
#466 OBJECTID k
#466 '('
#466 ')'
#466 ','
#466 OBJECTID i
#466 '('
#466 ')'
#466 ')'
#466 ','
#466 OBJECTID i
#466 '('
#466 ')'
#466 ')'
#466 ')'
#466 ';'
#467 OBJECTID gen_code
#467 '('
#467 OBJECTID app
#467 '('
#467 OBJECTID i
#467 '('
#467 ')'
#467 ','
#467 OBJECTID i
#467 '('
#467 ')'
#467 ')'
#467 ')'
#467 ';'
#468 OBJECTID gen_code
#468 '('
#468 OBJECTID app
#468 '('
#468 OBJECTID app
#468 '('
#468 OBJECTID app
#468 '('
#468 OBJECTID s
#468 '('
#468 ')'
#468 ','
#468 OBJECTID k
#468 '('
#468 ')'
#468 ')'
#468 ','
#468 OBJECTID i
#468 '('
#468 ')'
#468 ')'
#468 ','
#468 OBJECTID i
#468 '('
#468 ')'
#468 ')'
#468 ')'
#468 ';'
#469 OBJECTID gen_code
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID app
#469 '('
#469 OBJECTID i
#469 '('
#469 ')'
#469 ','
#469 OBJECTID k
#469 '('
#469 ')'
#469 ')'
#469 ','
#469 OBJECTID s
#469 '('
#469 ')'
#469 ')'
#469 ','
#469 OBJECTID s
#469 '('
#469 ')'
#469 ')'
#469 ','
#470 OBJECTID k
#470 '('
#470 ')'
#470 ')'
#470 ','
#470 OBJECTID s
#470 '('
#470 ')'
#470 ')'
#470 ','
#470 OBJECTID i
#470 '('
#470 ')'
#470 ')'
#470 ','
#470 OBJECTID k
#470 '('
#470 ')'
#470 ')'
#470 ','
#470 OBJECTID i
#470 '('
#470 ')'
#470 ')'
#470 ')'
#470 ';'
#471 OBJECTID gen_code
#471 '('
#471 OBJECTID app
#471 '('
#471 OBJECTID app
#471 '('
#471 OBJECTID i
#471 '('
#471 ')'
#471 ','
#471 OBJECTID app
#471 '('
#471 OBJECTID k
#471 '('
#471 ')'
#471 ','
#471 OBJECTID s
#471 '('
#471 ')'
#471 ')'
#471 ')'
#471 ','
#471 OBJECTID app
#471 '('
#471 OBJECTID k
#471 '('
#471 ')'
#471 ','
#471 OBJECTID app
#471 '('
#471 OBJECTID s
#471 '('
#471 ')'
#471 ','
#471 OBJECTID s
#471 '('
#471 ')'
#471 ')'
#471 ')'
#471 ')'
#471 ')'
#471 ';'
#472 INT_CONST 0
#472 ';'
#473 '}'
#474 '}'
#474 ';'
#475 '}'
#475 ';'
